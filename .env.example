# NXvms Docker Deployment Configuration
# Copy this file to .env and update values for your environment
# SECURITY: Never commit .env to version control
# For production: use strong passwords (minimum 16+ characters)

# ============================================================
# DATABASE CONFIGURATION
# ============================================================
# PostgreSQL internal hostname (DO NOT CHANGE)
DB_HOST=postgres

# PostgreSQL port (change if 5432 is already in use on host)
DB_PORT=5432

# PostgreSQL username (do not use 'postgres')
DB_USER=nxvms

# PostgreSQL password - CHANGE THIS IN PRODUCTION!
# Security: Use strong, random password (minimum 16 characters)
# Generate: openssl rand -base64 32
DB_PASSWORD=nxvms_password

# PostgreSQL database name
DB_NAME=nxvms

# ============================================================
# SERVER CONFIGURATION
# ============================================================
# Environment (development, production, staging)
# For production: use 'production'
NODE_ENV=production

# Server port (change if 3000 is already in use)
SERVER_PORT=3000

# Server hostname (0.0.0.0 to listen on all interfaces)
SERVER_HOST=0.0.0.0

# JWT Secret - CHANGE THIS IN PRODUCTION!
# Security: minimum 32 characters, use strong random value
# Generate: openssl rand -base64 32
JWT_SECRET=your-super-secret-jwt-key-change-this

# JWT token expiration time
JWT_EXPIRATION=24h

# JWT refresh token expiration time
JWT_REFRESH_EXPIRATION=7d

# Log level (debug, info, warn, error)
LOG_LEVEL=info

# ============================================================
# CORS CONFIGURATION
# ============================================================
# IMPORTANT: Controls which origins can access the API from browsers
# Security: Use wildcard (*) only for development!
# Production: Specify exact origins (comma-separated, no spaces after commas)
# 
# Examples:
#   - Localhost only:           CORS_ORIGIN=http://localhost:5173
#   - Multiple origins:         CORS_ORIGIN=http://localhost:5173,http://10.1.1.174:5173
#   - With authentication:      CORS_ORIGIN=https://app.example.com,https://dashboard.example.com
#   - Allow all (DEV ONLY):     CORS_ORIGIN=*
#
# Default (localhost only):
CORS_ORIGIN=*

# ============================================================
# STORAGE CONFIGURATION
# ============================================================
# Storage path for uploads, exports, and HLS streams
# This directory is persisted in the Docker volume nxvms_storage
STORAGE_PATH=/mnt/nxvms/storage

# ============================================================
# FFmpeg CONFIGURATION
# ============================================================
# FFmpeg binary path in Docker container
# DO NOT CHANGE - FFmpeg is pre-installed in the server image
FFMPEG_PATH=/usr/bin/ffmpeg

# FFmpeg operation timeout in milliseconds
FFMPEG_TIMEOUT=30000

# ============================================================
# VIDEO CODEC SETTINGS
# ============================================================
# Default video codec (h264, h265, vp9, av1)
VIDEO_CODEC=h264

# Default audio codec (aac, opus, libmp3lame)
AUDIO_CODEC=aac

# ============================================================
# CLIENT CONFIGURATION
# ============================================================
# Client port (change if 5173 is already in use)
CLIENT_PORT=5173

# API base URL for frontend requests
# This URL is used by the browser to connect to the API
# In production with reverse proxy: https://yourdomain.com/api
VITE_API_BASE_URL=http://localhost:3000/api

# Application title displayed in browser and UI
VITE_APP_TITLE=NXvms

# ============================================================
# DOCKER CONFIGURATION
# ============================================================
# Timezone for all containers
TZ=America/Argentina/Buenos_Aires

# ============================================================
# SECURITY BEST PRACTICES
# ============================================================
# 1. Change default passwords before production deployment
# 2. Use strong, randomly generated secrets (openssl rand -base64 32)
# 3. Store .env file securely with restricted permissions (chmod 600)
# 4. Never commit .env to version control (add to .gitignore)
# 5. Use environment-specific .env files (.env.prod, .env.staging)
# 6. Rotate secrets regularly
# 7. Use HTTPS/TLS in production with reverse proxy
# 8. Implement IP whitelisting if possible
# 9. Monitor container logs for suspicious activity
# 10. Keep Docker images updated

# ============================================================
# COMMON DOCKER COMMANDS
# ============================================================
# Validate configuration:
#   docker compose config
#
# Start all services:
#   docker compose up -d
#
# Stop all services:
#   docker compose down
#
# View real-time logs:
#   docker compose logs -f
#
# View specific service logs:
#   docker compose logs -f server
#
# Check service status:
#   docker compose ps
#
# Restart a service:
#   docker compose restart server
#
# Rebuild images:
#   docker compose build --no-cache
#
# Database backup:
#   docker compose exec postgres pg_dump -U $DB_USER $DB_NAME > backup.sql
#
# Database restore:
#   docker compose exec -T postgres psql -U $DB_USER $DB_NAME < backup.sql
#
# Access shell inside container:
#   docker compose exec server bash
#   docker compose exec client sh
#   docker compose exec postgres psql -U $DB_USER -d $DB_NAME

# Bitrate for transcoding (e.g., 2000k)
BITRATE=2000k

# ============================================================
# Client Configuration
# ============================================================
# API base URL for frontend
VITE_API_BASE_URL=http://localhost:3000/api/v1

# Debug mode for frontend
VITE_DEBUG=false

# ============================================================
# Application Settings
# ============================================================
# Application name
APP_NAME=NXvms

# Application environment
APP_ENV=production

# ============================================================
# Logging Configuration
# ============================================================
LOG_LEVEL=info
LOG_FORMAT=json
